<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>BlazorAppWasm</title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link href="BlazorAppWasm.styles.css" rel="stylesheet" />
</head>

<body>
    <div id="app">Loading...</div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ğŸ—™</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script>
        // åˆ›å»ºå‘½åç©ºé—´é¿å…å…¨å±€æ±¡æŸ“
        window.myJsHelpers = {
            showNotification: function (message, type) {
                // æ¨¡æ‹Ÿæ˜¾ç¤ºä¸€ä¸ªæ¼‚äº®çš„æç¤ºæ¡†
                const notification = document.createElement('div');
                notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        padding: 15px 20px;
                        border-radius: 5px;
                        color: white;
                        z-index: 1000;
                        transition: all 0.3s ease;
                    `;

                if (type === 'success') {
                    notification.style.backgroundColor = '#28a745';
                } else if (type === 'error') {
                    notification.style.backgroundColor = '#dc3545';
                } else {
                    notification.style.backgroundColor = '#17a2b8';
                }

                notification.textContent = message;
                document.body.appendChild(notification);

                // 3ç§’åè‡ªåŠ¨æ¶ˆå¤±
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            },

            getBrowserInfo: function () {
                return {
                    userAgent: navigator.userAgent,
                    language: navigator.language,
                    platform: navigator.platform
                };
            },

            // å¸¦å‚æ•°çš„è®¡ç®—å‡½æ•°
            calculateDiscount: function (originalPrice, discountPercent) {
                return originalPrice * (1 - discountPercent / 100);
            }
        };

        //demo1
        function registerDotNetHelper(dotNetHelper) {
            // å­˜å‚¨.NETå¼•ç”¨ä¾›åç»­ä½¿ç”¨
            window.dotNetHelper = dotNetHelper;

            // æ¼”ç¤ºè°ƒç”¨.NETæ–¹æ³•
            callDotNetMethods();
        }

        async function callDotNetMethods() {
            if (!window.dotNetHelper) {
                console.error('.NET helper æœªæ³¨å†Œ');
                return;
            }

            try {
                // è°ƒç”¨æ— å‚æ•°çš„.NETæ–¹æ³•
                const message = await window.dotNetHelper.invokeMethodAsync('GetFormattedMessage');

                // è°ƒç”¨å¸¦å‚æ•°çš„å¼‚æ­¥.NETæ–¹æ³•
                const processed = await window.dotNetHelper.invokeMethodAsync('ProcessDataAsync', 'hello world');

                // è°ƒç”¨voidæ–¹æ³•
                window.dotNetHelper.invokeMethodAsync('ShowAlert', 'è¿™æ˜¯ä»JSå‘æ¥çš„æ¶ˆæ¯ï¼');

                // åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºç»“æœ
                const output = document.getElementById('js-output');
                output.innerHTML = `
                <strong>æ¥è‡ª.NETçš„æ¶ˆæ¯:</strong> ${message}<br>
                <strong>å¤„ç†åçš„æ•°æ®:</strong> ${processed}
                `;

            } catch (error) {
                console.error('è°ƒç”¨.NETæ–¹æ³•å¤±è´¥:', error);
            }
        }
    </script>
</body>

</html>
