@page "/"

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app.

<SurveyPrompt Title="Blazor 的工作方式是怎样的？" />

<button class="@Theme?.ButtonClass">Click Me</button>

<ParmComp2 type="text" width="200px" placeholder="please enter your name" maxlength="10"></ParmComp2>
<MyButton class="btn-primary"
		  id="submit-btn"
		  onclick="console.log('clicked me')"
		  data-custom="value">
	点击我
</MyButton>
<FlexContainer class="my-styles"
			   id="main-container"
			   style="background-color: lightblue;"
			   data-tracking="user-section"
			   aria-label="主要区域">
	<p>这里是可以自定义样式的容器内容</p>
</FlexContainer>



<!-- 可编辑的用户列表 -->
<style>
	/* 在父组件中添加样式 */
	.user-list {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
		gap: 20px;
		padding: 20px;
	}

	.user-grid {
		display: flex;
		flex-wrap: wrap;
		gap: 15px;
		margin: 20px 0;
	}

	.pagination {
		display: flex;
		justify-content: center;
		align-items: center;
		gap: 10px;
		margin-top: 20px;
	}

	.editable-user-list .user-item {
		display: flex;
		align-items: center;
		gap: 10px;
		margin-bottom: 10px;
	}

	.add-user-form {
		margin-top: 20px;
		padding: 15px;
		border: 1px solid #ddd;
		border-radius: 5px;
	}
</style>
<div class="editable-user-list">
	<h3>可编辑用户列表</h3>

	@foreach (var user in editableUsers)
	{
		<div class="user-item">
			<UserCard UserName="@user.Name"
					  Email="@user.Email"
					  AvatarUrl="@user.AvatarUrl"
					  JoinDate="@user.JoinDate" />

			<button @onclick="() => RemoveUser(user)" class="btn btn-danger">删除</button>
		</div>
	}

	<!-- 添加新用户 -->
	<div class="add-user-form">
		<input @bind="newUserName" placeholder="用户名" />
		<input @bind="newUserEmail" placeholder="邮箱" />
		<button @onclick="AddUser" class="btn btn-success">添加用户</button>
	</div>
	<div class="format-demo">
		<h4>格式化绑定示例</h4>

		<!-- 日期格式化 -->
		<input @bind="startDate" @bind:format="yyyy-MM-dd" type="date" />
		<p>选择的日期: @startDate.ToString("yyyy年MM月dd日")</p>

		<!-- 数字格式化 -->
		<input @bind="price1" type="number" step="0.01" />
		<p>价格: @price1.ToString("C")</p>
	</div>

</div>
<OptimizedEvents />



@code {
	public class User
	{
		public string Name { get; set; } = string.Empty;
		public string Email { get; set; } = string.Empty;
		public string AvatarUrl { get; set; } = string.Empty;
		public DateTime JoinDate { get; set; }
	}
	private List<User> editableUsers = new();
	private string newUserName = string.Empty;
	private string newUserEmail = string.Empty;

	private bool isDisabled = false;
	// 通过 CascadingParameter 获取级联值
	[CascadingParameter]
	protected ThemeInfo? Theme { get; set; }

	protected override async Task OnInitializedAsync()
	{
		await Task.Delay(5000);
		// 初始化数据
		editableUsers = new List<User>
		{
			new User { Name = "张三", Email = "zhangsan@email.com", AvatarUrl = "/images/avatar1.jpg", JoinDate = DateTime.Now.AddDays(-100) },
			new User { Name = "李四", Email = "lisi@email.com", AvatarUrl = "/images/avatar2.jpg", JoinDate = DateTime.Now.AddDays(-50) }
		};
	}

	private void AddUser()
	{
		if (!string.IsNullOrWhiteSpace(newUserName) && !string.IsNullOrWhiteSpace(newUserEmail))
		{
			var newUser = new User
				{
					Name = newUserName,
					Email = newUserEmail,
					AvatarUrl = "/images/default-avatar.jpg",
					JoinDate = DateTime.Now
				};

			editableUsers.Add(newUser);

			// 清空输入框
			newUserName = string.Empty;
			newUserEmail = string.Empty;

			StateHasChanged();
		}
	}

	private void RemoveUser(User user)
	{
		editableUsers.Remove(user);
		StateHasChanged();
	}

	private DateTime startDate = DateTime.Today;
	private decimal price1 = 0.00m;

}